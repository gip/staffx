---
kind: "Document"
hash: "sha256:ac7c09fdc6f09562d2f4dae7f768d4256116763fb07ddc5c5a9615ae6dc74227"
title: "Feature: Topology and Matrix Editing"
language: "en"
---

# Topology and Matrix Editing

## Purpose
Expose and persist architecture topology and concern matrix context during thread work.

## Capabilities
- Read topology nodes and edges for current thread system.
- Read matrix cells, concerns, and documents for current thread system.
- Persist node layout coordinates through matrix patch endpoint.

## Workflow
- UI renders topology using React Flow with optional auto-layout behavior.
- Matrix tab displays node by concern cells and attached docs and artifacts.
- Layout updates write metadata.layout values on node rows.
- Matrix changes publish thread.matrix.changed event for UI refresh propagation.

## Data touched
- nodes metadata
- edges
- concerns
- matrix_refs
- documents
- staffx_events

## Failure modes
- Empty layout payload rejected.
- Node update count zero returns not found semantics.
- Thread access guard handles invalid or ambiguous route identifiers.

## Source traceability
- apps/api/src/routes/v1.ts
- packages/ui/src/thread-page.tsx
- apps/web/src/app.tsx
- apps/desktop/src/renderer/app.tsx
