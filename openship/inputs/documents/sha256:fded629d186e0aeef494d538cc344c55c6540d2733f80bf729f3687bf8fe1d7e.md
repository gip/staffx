---
kind: "Document"
hash: "sha256:fded629d186e0aeef494d538cc344c55c6540d2733f80bf729f3687bf8fe1d7e"
title: "Security Controls and Threat Boundaries"
language: "en"
---

# Security Controls and Threat Boundaries

## Authentication controls
- Bearer tokens are validated against issuer, audience, and Auth0 JWKS.
- Optional authentication routes explicitly branch between anonymous and authenticated access behavior.

## Authorization controls
- Access role is computed from ownership, collaborator grants, and project visibility.
- Mutating endpoints enforce owner or editor role checks before writes.
- Run claim and completion endpoints enforce thread-level access before state mutation.

## Integration credential controls
- External provider tokens are encrypted at rest using AES-256-GCM.
- OAuth state values are random and time-bounded.
- Callback return targets are sanitized to trusted origin.

## Data integrity controls
- Database enum constraints and check constraints prevent invalid state classes.
- Deferrable root validation trigger enforces one valid root node per system.
- Unique index prevents concurrent running runs on the same thread.

## Operational boundaries
- Desktop token state is memory resident in main process.
- API process uses environment variables for secrets and provider credentials.
- OpenShip reconciliation rejects malformed bundles and unresolved references before commit.
