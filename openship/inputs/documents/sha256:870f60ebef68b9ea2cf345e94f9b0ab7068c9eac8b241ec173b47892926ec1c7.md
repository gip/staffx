---
kind: Document
hash: sha256:870f60ebef68b9ea2cf345e94f9b0ab7068c9eac8b241ec173b47892926ec1c7
title: Rebuild Prerequisites and Runbook
language: en
---

This runbook defines prerequisites and sequencing to rebuild the runtime from an empty environment.

Prerequisites:
- Node.js and pnpm versions compatible with the workspace package manager configuration.
- PostgreSQL instance reachable from the API process with a database created for the runtime.
- Auth0 tenant and application configured for both web and desktop redirect/logout flows.
- Google and Notion OAuth application credentials, callback URIs, and scopes aligned with integration endpoints.
- Environment variables provided for API, web, and desktop processes, including database connection, auth issuer/audience, client identifiers, and optional agent-runner settings.

Build and bootstrap order:
1. Install workspace dependencies.
2. Apply database migrations.
3. Build or run API in watch mode and verify health endpoint readiness.
4. Start web and desktop clients, then verify authentication round-trip.
5. Validate integrations state/list/status endpoints and callback handling.
6. Create a project, create/clone threads, update matrix state, and verify event stream updates.
7. Execute assistant run lifecycle operations and confirm completion events plus optional OpenShip reconciliation.

Operational checkpoints:
- Health checks pass and DB time can be queried from API health route.
- Authenticated calls to identity and project endpoints succeed with expected authorization behavior.
- Event polling and SSE resume semantics work with cursor/last-event-id.
- Integration tokens can be connected, status-checked, and disconnected.
- OpenShip bundle generation and apply operations succeed without topology or matrix validation errors.

Failure handling guidance:
- Treat migration drift, invalid OAuth state, and matrix/doc reference mismatches as hard-stop errors.
- Use event logs and request traces to isolate failure stage before retries.
- Do not proceed to assistant-run reconciliation until project/thread CRUD and eventing are stable.
